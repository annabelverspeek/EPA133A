import pandas as pd
import matplotlib.pyplot as plt

'reading the Vulnerability and Criticality that were created in the python files Bridges Bridge_conditions_added.py and latlon RRMS.py'
vulnerability_file = '../output/Vulnerability.csv'
vulnerability_df = pd.read_csv(vulnerability_file)
print(vulnerability_df)

criticality_file = '../output/Criticality.csv'
criticality_df = pd.read_csv(criticality_file)
print(criticality_df)


'The scores given to the road segments are detemermined by their ranking, \
 so in the code below creates a new column in both dfs named score_x and score_y'
vulnerability_df['score_x'] = vulnerability_df.index

criticality_df['score_y'] = criticality_df.index

'The criticality and vulnerability dataframes will be merged (inner) on name, \
 so that only the segments that can be found in both dataframes are taken into the new df'
merged_df = pd.merge(vulnerability_df, criticality_df, on='name')

merged_df['total_score']= merged_df['score_x'] + merged_df['score_y']

merged_df.sort_values(by='total_score', ascending=False, inplace=True)

'plotting top 10 of the most important road segments'
merged_df_top10 = merged_df.head(10)
print(merged_df_top10)

plt.figure(figsize=(8, 6))
plt.barh(merged_df_top10['name'], merged_df_top10['total_score'], color='red')
plt.xlabel('Vulnerability and criticality of Roads')
plt.ylabel('Road Names')
plt.title(f'Top 10 Roads by Vulnerability and criticality')
plt.gca().invert_yaxis()
plt.tick_params(axis='y', which='major', labelsize=8) # Invert y-axis to display the highest-ranking road at the top
plt.show()